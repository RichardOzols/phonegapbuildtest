<!DOCTYPE html>
<html>
    <head>
        <title>PGB Kitchen Sink</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        
    </head>
    <body>

		<div data-role="page" id="pageCompass" data-cache="never">
			<script type="text/javascript" charset="utf-8">
				var compassInterval;
				
				$("#pageCompass").bind('pageinit', function() {
					$("#selCompass").off('change').on('change', function() {
						if ($(this).val() == 'on') {
							compassInterval = setInterval(updateHeading, 500);
						}
						else
						{
							clearInterval(compassInterval);
						}
						alert($(this).val());
					});
				});
				
				function updateHeading() {
					navigator.compass.getCurrentHeading(compassSuccess, compassError);
				}
				
				function compassSuccess(heading) {
					//alert('Heading: ' + heading.magneticHeading);
					$("#currentHeading").text(heading.magneticHeading);
				};

				function compassError(error) {
					//alert('CompassError: ' + error.code);
					$("#currentHeading").text(error.code);
				};
			</script>
		
			<div data-role="header">
				<h1>Compass</h1>
			</div><!-- /header -->

			<div data-role="content">	
			
				<label for="selCompass">Compass:</label>
				<select name="selCompass" id="selCompass" data-role="slider" data-theme="c" data-track-theme="a">
						<option value="on">On</option>
						<option value="off">Off</option>
				</select>
				
				<div id="currentHeading"></div>
				
			</div><!-- /content -->

		</div><!-- /page -->
    				
    </body>
</html>